import{u as _,f as te,g as se,h as U,i as Ee,P as re,t as le,j as ae,k as L,l as f,m as ue,n as Y,p as s,q as oe,R as T,s as ie,v as ne,x as Be,C as ce,y as Ae,z as pe,A as ve,B as he,D as ye,E as H,F as de,G as me,H as Ce,I as $,J as j,K as De}from"./app-4zm6bqRA.js";const ge=["/","/notes/","/reports/","/notes/Introduction%20to%20Modern%20Cryptography/1.html","/notes/Introduction%20to%20Modern%20Cryptography/2.html","/notes/Introduction%20to%20Modern%20Cryptography/","/notes/%E6%95%B0%E6%8D%AE%E5%BA%93/","/notes/%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%85%B3%E7%B3%BB%E6%93%8D%E4%BD%9C.html","/notes/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93SQL.html","/notes/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8%E6%80%A7.html","/notes/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%8C%E6%95%B4%E6%80%A7.html","/notes/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B.html","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%AE%9E%E9%AA%8C%E4%B8%80%20openEuler%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20%E7%BC%96%E8%AF%91%E5%86%85%E6%A0%B8%E5%AE%9E%E9%AA%8C.html","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%AE%9E%E9%AA%8C%E4%B8%89%20openEuler%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20%E5%86%85%E6%A0%B8%E6%97%B6%E9%97%B4%E7%AE%A1%E7%90%86.html","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%AE%9E%E9%AA%8C%E4%BA%8C%20openEuler%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86%E5%AE%9E%E9%AA%8C.html","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%AE%9E%E9%AA%8C%E4%BA%94%20openEuler%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%AE%9E%E9%AA%8C.html","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%AE%9E%E9%AA%8C%E5%85%ADopenEuler%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F.html","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%AE%9E%E9%AA%8C%E5%9B%9B%20openEuler%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20%E4%B8%AD%E6%96%AD%E5%92%8C%E5%BC%82%E5%B8%B8.html","/reports/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/1.html","/reports/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/2.html","/reports/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/3.html","/reports/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/4.html","/reports/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/5.html","/reports/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/","/404.html","/category/","/category/note/","/category/%E6%8A%A5%E5%91%8A/","/category/%E5%AF%86%E7%A0%81%E5%AD%A6/","/category/%E7%AC%94%E8%AE%B0/","/category/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/","/tag/","/tag/%E7%AC%94%E8%AE%B0/","/tag/%E6%95%B0%E6%8D%AE%E5%BA%93/","/tag/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/","/tag/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/","/tag/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/","/article/","/star/","/timeline/"],Fe="SEARCH_PRO_QUERY_HISTORY",y=_(Fe,[]),fe=()=>{const{queryHistoryCount:E}=H,r=E>0;return{enabled:r,queryHistory:y,addQueryHistory:l=>{r&&(y.value=Array.from(new Set([l,...y.value.slice(0,E-1)])))},removeQueryHistory:l=>{y.value=[...y.value.slice(0,l),...y.value.slice(l+1)]}}},b=E=>ge[E.id]+("anchor"in E?`#${E.anchor}`:""),He="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:M}=H,d=_(He,[]),Re=()=>{const E=M>0;return{enabled:E,resultHistory:d,addResultHistory:r=>{if(E){const l={link:b(r),display:r.display};"header"in r&&(l.header=r.header),d.value=[l,...d.value.slice(0,M-1)]}},removeResultHistory:r=>{d.value=[...d.value.slice(0,r),...d.value.slice(r+1)]}}},ke=E=>{const r=ce(),l=U(),R=Ae(),u=L(0),D=f(()=>u.value>0),p=pe([]);return ve(()=>{const{search:v,terminate:k}=he(),m=ye(n=>{const C=n.join(" "),{searchFilter:Q=A=>A,splitWord:w,suggestionsFilter:I,...h}=r.value;C?(u.value+=1,v(n.join(" "),l.value,h).then(A=>Q(A,C,l.value,R.value)).then(A=>{u.value-=1,p.value=A}).catch(A=>{console.warn(A),u.value-=1,u.value||(p.value=[])})):p.value=[]},H.searchDelay-H.suggestDelay);Y([E,l],([n])=>m(n),{immediate:!0}),de(()=>{k()})}),{isSearching:D,results:p}};var we=te({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(E,{emit:r}){const l=se(),R=U(),u=Ee(re),{enabled:D,addQueryHistory:p,queryHistory:v,removeQueryHistory:k}=fe(),{enabled:m,resultHistory:n,addResultHistory:C,removeResultHistory:Q}=Re(),w=D||m,I=le(E,"queries"),{results:h,isSearching:A}=ke(I),a=ae({isQuery:!0,index:0}),B=L(0),c=L(0),P=f(()=>w&&(v.value.length>0||n.value.length>0)),q=f(()=>h.value.length>0),x=f(()=>h.value[B.value]||null),z=()=>{const{isQuery:e,index:t}=a;t===0?(a.isQuery=!e,a.index=e?n.value.length-1:v.value.length-1):a.index=t-1},G=()=>{const{isQuery:e,index:t}=a;t===(e?v.value.length-1:n.value.length-1)?(a.isQuery=!e,a.index=0):a.index=t+1},J=()=>{B.value=B.value>0?B.value-1:h.value.length-1,c.value=x.value.contents.length-1},K=()=>{B.value=B.value<h.value.length-1?B.value+1:0,c.value=0},V=()=>{c.value<x.value.contents.length-1?c.value+=1:K()},N=()=>{c.value>0?c.value-=1:J()},S=e=>e.map(t=>De(t)?t:s(t[0],t[1])),W=e=>{if(e.type==="customField"){const t=me[e.index]||"$content",[o,F=""]=Ce(t)?t[R.value].split("$content"):t.split("$content");return e.display.map(i=>s("div",S([o,...i,F])))}return e.display.map(t=>s("div",S(t)))},g=()=>{B.value=0,c.value=0,r("updateQuery",""),r("close")},X=()=>D?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},u.value.queryHistory),v.value.map((e,t)=>s("div",{class:["search-pro-result-item",{active:a.isQuery&&a.index===t}],onClick:()=>{r("updateQuery",e)}},[s($,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},e),s("button",{class:"search-pro-remove-icon",innerHTML:j,onClick:o=>{o.preventDefault(),o.stopPropagation(),k(t)}})]))])):null,Z=()=>m?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},u.value.resultHistory),n.value.map((e,t)=>s(T,{to:e.link,class:["search-pro-result-item",{active:!a.isQuery&&a.index===t}],onClick:()=>{g()}},()=>[s($,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[e.header?s("div",{class:"content-header"},e.header):null,s("div",e.display.map(o=>S(o)).flat())]),s("button",{class:"search-pro-remove-icon",innerHTML:j,onClick:o=>{o.preventDefault(),o.stopPropagation(),Q(t)}})]))])):null;return ue("keydown",e=>{if(E.isFocusing){if(q.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")V();else if(e.key==="Enter"){const t=x.value.contents[c.value];p(E.queries.join(" ")),C(t),l.push(b(t)),g()}}else if(m){if(e.key==="ArrowUp")z();else if(e.key==="ArrowDown")G();else if(e.key==="Enter"){const{index:t}=a;a.isQuery?(r("updateQuery",v.value[t]),e.preventDefault()):(l.push(n.value[t].link),g())}}}}),Y([B,c],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>s("div",{class:["search-pro-result-wrapper",{empty:E.queries.length?!q.value:!P.value}],id:"search-pro-results"},E.queries.length?A.value?s(oe,{hint:u.value.searching}):q.value?s("ul",{class:"search-pro-result-list"},h.value.map(({title:e,contents:t},o)=>{const F=B.value===o;return s("li",{class:["search-pro-result-list-item",{active:F}]},[s("div",{class:"search-pro-result-title"},e||u.value.defaultTitle),t.map((i,ee)=>{const O=F&&c.value===ee;return s(T,{to:b(i),class:["search-pro-result-item",{active:O,"aria-selected":O}],onClick:()=>{p(E.queries.join(" ")),C(i),g()}},()=>[i.type==="text"?null:s(i.type==="title"?ie:i.type==="heading"?ne:Be,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[i.type==="text"&&i.header?s("div",{class:"content-header"},i.header):null,s("div",W(i))])])})])})):u.value.emptyResult:w?P.value?[X(),Z()]:u.value.emptyHistory:u.value.emptyResult)}});export{we as default};
