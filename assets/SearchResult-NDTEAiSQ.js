import{u as M,f as te,g as se,h as U,i as Ee,P as le,t as ae,j as re,k as L,l as f,m as ue,n as Y,p as s,q as oe,R as T,s as ie,v as ne,x as Be,C as ce,y as Ae,z as ve,A as pe,B as he,D as ye,E as H,F as de,G as me,H as De,I as $,J as j,K as Ce}from"./app-BfDW_Pj1.js";const ge=["/","/notes/","/reports/","/notes/Introduction%20to%20Modern%20Cryptography/1.html","/notes/Introduction%20to%20Modern%20Cryptography/","/notes/%E6%95%B0%E6%8D%AE%E5%BA%93/","/notes/%E6%95%B0%E6%8D%AE%E5%BA%93/%E5%85%B3%E7%B3%BB%E6%93%8D%E4%BD%9C.html","/notes/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93SQL.html","/notes/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8%E6%80%A7.html","/notes/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%8C%E6%95%B4%E6%80%A7.html","/notes/%E6%95%B0%E6%8D%AE%E5%BA%93/%E6%95%B0%E6%8D%AE%E5%BA%93%E7%BC%96%E7%A8%8B.html","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%AE%9E%E9%AA%8C%E4%B8%80%20openEuler%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20%E7%BC%96%E8%AF%91%E5%86%85%E6%A0%B8%E5%AE%9E%E9%AA%8C.html","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%AE%9E%E9%AA%8C%E4%B8%89%20openEuler%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20%E5%86%85%E6%A0%B8%E6%97%B6%E9%97%B4%E7%AE%A1%E7%90%86.html","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%AE%9E%E9%AA%8C%E4%BA%8C%20openEuler%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86%E5%AE%9E%E9%AA%8C.html","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%AE%9E%E9%AA%8C%E4%BA%94%20openEuler%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%AE%9E%E9%AA%8C.html","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%AE%9E%E9%AA%8C%E5%85%ADopenEuler%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F.html","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%AE%9E%E9%AA%8C%E5%9B%9B%20openEuler%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20%E4%B8%AD%E6%96%AD%E5%92%8C%E5%BC%82%E5%B8%B8.html","/reports/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/1.html","/reports/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/2.html","/reports/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/3.html","/reports/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/4.html","/reports/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/5.html","/reports/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/","/404.html","/category/","/category/note/","/category/%E6%8A%A5%E5%91%8A/","/category/%E5%AF%86%E7%A0%81%E5%AD%A6/","/category/%E7%AC%94%E8%AE%B0/","/category/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/","/tag/","/tag/%E7%AC%94%E8%AE%B0/","/tag/%E6%95%B0%E6%8D%AE%E5%BA%93/","/tag/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/","/tag/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/","/tag/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/","/article/","/star/","/timeline/"],Fe="SEARCH_PRO_QUERY_HISTORY",y=M(Fe,[]),fe=()=>{const{queryHistoryCount:E}=H,l=E>0;return{enabled:l,queryHistory:y,addQueryHistory:a=>{l&&(y.value=Array.from(new Set([a,...y.value.slice(0,E-1)])))},removeQueryHistory:a=>{y.value=[...y.value.slice(0,a),...y.value.slice(a+1)]}}},b=E=>ge[E.id]+("anchor"in E?`#${E.anchor}`:""),He="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:_}=H,d=M(He,[]),Re=()=>{const E=_>0;return{enabled:E,resultHistory:d,addResultHistory:l=>{if(E){const a={link:b(l),display:l.display};"header"in l&&(a.header=l.header),d.value=[a,...d.value.slice(0,_-1)]}},removeResultHistory:l=>{d.value=[...d.value.slice(0,l),...d.value.slice(l+1)]}}},ke=E=>{const l=ce(),a=U(),R=Ae(),u=L(0),C=f(()=>u.value>0),v=ve([]);return pe(()=>{const{search:p,terminate:k}=he(),m=ye(n=>{const D=n.join(" "),{searchFilter:Q=A=>A,splitWord:w,suggestionsFilter:I,...h}=l.value;D?(u.value+=1,p(n.join(" "),a.value,h).then(A=>Q(A,D,a.value,R.value)).then(A=>{u.value-=1,v.value=A}).catch(A=>{console.warn(A),u.value-=1,u.value||(v.value=[])})):v.value=[]},H.searchDelay-H.suggestDelay);Y([E,a],([n])=>m(n),{immediate:!0}),de(()=>{k()})}),{isSearching:C,results:v}};var we=te({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(E,{emit:l}){const a=se(),R=U(),u=Ee(le),{enabled:C,addQueryHistory:v,queryHistory:p,removeQueryHistory:k}=fe(),{enabled:m,resultHistory:n,addResultHistory:D,removeResultHistory:Q}=Re(),w=C||m,I=ae(E,"queries"),{results:h,isSearching:A}=ke(I),r=re({isQuery:!0,index:0}),B=L(0),c=L(0),P=f(()=>w&&(p.value.length>0||n.value.length>0)),q=f(()=>h.value.length>0),x=f(()=>h.value[B.value]||null),z=()=>{const{isQuery:e,index:t}=r;t===0?(r.isQuery=!e,r.index=e?n.value.length-1:p.value.length-1):r.index=t-1},G=()=>{const{isQuery:e,index:t}=r;t===(e?p.value.length-1:n.value.length-1)?(r.isQuery=!e,r.index=0):r.index=t+1},J=()=>{B.value=B.value>0?B.value-1:h.value.length-1,c.value=x.value.contents.length-1},K=()=>{B.value=B.value<h.value.length-1?B.value+1:0,c.value=0},V=()=>{c.value<x.value.contents.length-1?c.value+=1:K()},N=()=>{c.value>0?c.value-=1:J()},S=e=>e.map(t=>Ce(t)?t:s(t[0],t[1])),W=e=>{if(e.type==="customField"){const t=me[e.index]||"$content",[o,F=""]=De(t)?t[R.value].split("$content"):t.split("$content");return e.display.map(i=>s("div",S([o,...i,F])))}return e.display.map(t=>s("div",S(t)))},g=()=>{B.value=0,c.value=0,l("updateQuery",""),l("close")},X=()=>C?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},u.value.queryHistory),p.value.map((e,t)=>s("div",{class:["search-pro-result-item",{active:r.isQuery&&r.index===t}],onClick:()=>{l("updateQuery",e)}},[s($,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},e),s("button",{class:"search-pro-remove-icon",innerHTML:j,onClick:o=>{o.preventDefault(),o.stopPropagation(),k(t)}})]))])):null,Z=()=>m?s("ul",{class:"search-pro-result-list"},s("li",{class:"search-pro-result-list-item"},[s("div",{class:"search-pro-result-title"},u.value.resultHistory),n.value.map((e,t)=>s(T,{to:e.link,class:["search-pro-result-item",{active:!r.isQuery&&r.index===t}],onClick:()=>{g()}},()=>[s($,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[e.header?s("div",{class:"content-header"},e.header):null,s("div",e.display.map(o=>S(o)).flat())]),s("button",{class:"search-pro-remove-icon",innerHTML:j,onClick:o=>{o.preventDefault(),o.stopPropagation(),Q(t)}})]))])):null;return ue("keydown",e=>{if(E.isFocusing){if(q.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")V();else if(e.key==="Enter"){const t=x.value.contents[c.value];v(E.queries.join(" ")),D(t),a.push(b(t)),g()}}else if(m){if(e.key==="ArrowUp")z();else if(e.key==="ArrowDown")G();else if(e.key==="Enter"){const{index:t}=r;r.isQuery?(l("updateQuery",p.value[t]),e.preventDefault()):(a.push(n.value[t].link),g())}}}}),Y([B,c],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>s("div",{class:["search-pro-result-wrapper",{empty:E.queries.length?!q.value:!P.value}],id:"search-pro-results"},E.queries.length?A.value?s(oe,{hint:u.value.searching}):q.value?s("ul",{class:"search-pro-result-list"},h.value.map(({title:e,contents:t},o)=>{const F=B.value===o;return s("li",{class:["search-pro-result-list-item",{active:F}]},[s("div",{class:"search-pro-result-title"},e||u.value.defaultTitle),t.map((i,ee)=>{const O=F&&c.value===ee;return s(T,{to:b(i),class:["search-pro-result-item",{active:O,"aria-selected":O}],onClick:()=>{v(E.queries.join(" ")),D(i),g()}},()=>[i.type==="text"?null:s(i.type==="title"?ie:i.type==="heading"?ne:Be,{class:"search-pro-result-type"}),s("div",{class:"search-pro-result-content"},[i.type==="text"&&i.header?s("div",{class:"content-header"},i.header):null,s("div",W(i))])])})])})):u.value.emptyResult:w?P.value?[X(),Z()]:u.value.emptyHistory:u.value.emptyResult)}});export{we as default};
