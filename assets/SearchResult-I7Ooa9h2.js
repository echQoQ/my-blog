import{u as U,f as se,g as te,h as Y,i as le,P as ae,t as re,j as ue,k as L,l as f,m as Ee,n as M,p as t,q as ie,R as $,s as oe,v as ne,x as ce,C as Be,y as ve,z as pe,A as he,B as de,D as Ae,E as H,F as ye,G as me,H as Ce,I as j,J as I,K as De}from"./app-CBUCxWSa.js";const Fe=["/","/reports/","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%AE%9E%E9%AA%8C%E4%B8%80%20openEuler%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20%E7%BC%96%E8%AF%91%E5%86%85%E6%A0%B8%E5%AE%9E%E9%AA%8C.html","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%AE%9E%E9%AA%8C%E4%B8%89%20openEuler%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20%E5%86%85%E6%A0%B8%E6%97%B6%E9%97%B4%E7%AE%A1%E7%90%86.html","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%AE%9E%E9%AA%8C%E4%BA%8C%20openEuler%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86%E5%AE%9E%E9%AA%8C.html","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%AE%9E%E9%AA%8C%E4%BA%94%20openEuler%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%AE%9E%E9%AA%8C.html","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%AE%9E%E9%AA%8C%E5%85%ADopenEuler%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F.html","/reports/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/%E5%AE%9E%E9%AA%8C%E5%9B%9B%20openEuler%20%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%20%E4%B8%AD%E6%96%AD%E5%92%8C%E5%BC%82%E5%B8%B8.html","/reports/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/1.html","/reports/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/2.html","/reports/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/3.html","/reports/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/4.html","/reports/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/5.html","/reports/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/","/404.html","/category/","/category/%E6%8A%A5%E5%91%8A/","/category/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/","/tag/","/tag/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/","/tag/%E5%AE%9E%E9%AA%8C%E6%8A%A5%E5%91%8A/","/tag/%E7%BC%96%E8%AF%91%E5%8E%9F%E7%90%86/","/article/","/star/","/timeline/"],ge="SEARCH_PRO_QUERY_HISTORY",A=U(ge,[]),fe=()=>{const{queryHistoryCount:l}=H,a=l>0;return{enabled:a,queryHistory:A,addQueryHistory:r=>{a&&(A.value=Array.from(new Set([r,...A.value.slice(0,l-1)])))},removeQueryHistory:r=>{A.value=[...A.value.slice(0,r),...A.value.slice(r+1)]}}},b=l=>Fe[l.id]+("anchor"in l?`#${l.anchor}`:""),He="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:_}=H,y=U(He,[]),Re=()=>{const l=_>0;return{enabled:l,resultHistory:y,addResultHistory:a=>{if(l){const r={link:b(a),display:a.display};"header"in a&&(r.header=a.header),y.value=[r,...y.value.slice(0,_-1)]}},removeResultHistory:a=>{y.value=[...y.value.slice(0,a),...y.value.slice(a+1)]}}},ke=l=>{const a=Be(),r=Y(),R=ve(),E=L(0),D=f(()=>E.value>0),p=pe([]);return he(()=>{const{search:h,terminate:k}=de(),m=Ae(n=>{const C=n.join(" "),{searchFilter:Q=v=>v,splitWord:w,suggestionsFilter:P,...d}=a.value;C?(E.value+=1,h(n.join(" "),r.value,d).then(v=>Q(v,C,r.value,R.value)).then(v=>{E.value-=1,p.value=v}).catch(v=>{console.warn(v),E.value-=1,E.value||(p.value=[])})):p.value=[]},H.searchDelay-H.suggestDelay);M([l,r],([n])=>m(n),{immediate:!0}),ye(()=>{k()})}),{isSearching:D,results:p}};var we=se({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:a}){const r=te(),R=Y(),E=le(ae),{enabled:D,addQueryHistory:p,queryHistory:h,removeQueryHistory:k}=fe(),{enabled:m,resultHistory:n,addResultHistory:C,removeResultHistory:Q}=Re(),w=D||m,P=re(l,"queries"),{results:d,isSearching:v}=ke(P),u=ue({isQuery:!0,index:0}),c=L(0),B=L(0),O=f(()=>w&&(h.value.length>0||n.value.length>0)),q=f(()=>d.value.length>0),x=f(()=>d.value[c.value]||null),z=()=>{const{isQuery:e,index:s}=u;s===0?(u.isQuery=!e,u.index=e?n.value.length-1:h.value.length-1):u.index=s-1},G=()=>{const{isQuery:e,index:s}=u;s===(e?h.value.length-1:n.value.length-1)?(u.isQuery=!e,u.index=0):u.index=s+1},J=()=>{c.value=c.value>0?c.value-1:d.value.length-1,B.value=x.value.contents.length-1},K=()=>{c.value=c.value<d.value.length-1?c.value+1:0,B.value=0},V=()=>{B.value<x.value.contents.length-1?B.value+=1:K()},N=()=>{B.value>0?B.value-=1:J()},S=e=>e.map(s=>De(s)?s:t(s[0],s[1])),W=e=>{if(e.type==="customField"){const s=me[e.index]||"$content",[i,g=""]=Ce(s)?s[R.value].split("$content"):s.split("$content");return e.display.map(o=>t("div",S([i,...o,g])))}return e.display.map(s=>t("div",S(s)))},F=()=>{c.value=0,B.value=0,a("updateQuery",""),a("close")},X=()=>D?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},E.value.queryHistory),h.value.map((e,s)=>t("div",{class:["search-pro-result-item",{active:u.isQuery&&u.index===s}],onClick:()=>{a("updateQuery",e)}},[t(j,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},e),t("button",{class:"search-pro-remove-icon",innerHTML:I,onClick:i=>{i.preventDefault(),i.stopPropagation(),k(s)}})]))])):null,Z=()=>m?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},E.value.resultHistory),n.value.map((e,s)=>t($,{to:e.link,class:["search-pro-result-item",{active:!u.isQuery&&u.index===s}],onClick:()=>{F()}},()=>[t(j,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(i=>S(i)).flat())]),t("button",{class:"search-pro-remove-icon",innerHTML:I,onClick:i=>{i.preventDefault(),i.stopPropagation(),Q(s)}})]))])):null;return Ee("keydown",e=>{if(l.isFocusing){if(q.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")V();else if(e.key==="Enter"){const s=x.value.contents[B.value];p(l.queries.join(" ")),C(s),r.push(b(s)),F()}}else if(m){if(e.key==="ArrowUp")z();else if(e.key==="ArrowDown")G();else if(e.key==="Enter"){const{index:s}=u;u.isQuery?(a("updateQuery",h.value[s]),e.preventDefault()):(r.push(n.value[s].link),F())}}}}),M([c,B],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["search-pro-result-wrapper",{empty:l.queries.length?!q.value:!O.value}],id:"search-pro-results"},l.queries.length?v.value?t(ie,{hint:E.value.searching}):q.value?t("ul",{class:"search-pro-result-list"},d.value.map(({title:e,contents:s},i)=>{const g=c.value===i;return t("li",{class:["search-pro-result-list-item",{active:g}]},[t("div",{class:"search-pro-result-title"},e||E.value.defaultTitle),s.map((o,ee)=>{const T=g&&B.value===ee;return t($,{to:b(o),class:["search-pro-result-item",{active:T,"aria-selected":T}],onClick:()=>{p(l.queries.join(" ")),C(o),F()}},()=>[o.type==="text"?null:t(o.type==="title"?oe:o.type==="heading"?ne:ce,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[o.type==="text"&&o.header?t("div",{class:"content-header"},o.header):null,t("div",W(o))])])})])})):E.value.emptyResult:w?O.value?[X(),Z()]:E.value.emptyHistory:E.value.emptyResult)}});export{we as default};
